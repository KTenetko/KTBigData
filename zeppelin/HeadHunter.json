{"paragraphs":[{"text":"%md\n##Analysis of HeadHunter Resumes\n\nby Kristina Tenetko\n\n\n","dateUpdated":"2016-12-11T01:19:59+0400","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481327082845_-1808383520","id":"20161210-034442_773300941","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>Analysis of HeadHunter Resumes</h2>\n<p>by Kristina Tenetko</p>\n"},"dateCreated":"2016-12-10T03:44:42+0400","dateStarted":"2016-12-11T01:19:50+0400","dateFinished":"2016-12-11T01:19:50+0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:283"},{"text":"","dateUpdated":"2016-12-13T23:32:34+0400","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala","editorHide":false,"tableHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481500024479_-1047841436","id":"20161212-034704_765412326","dateCreated":"2016-12-12T03:47:04+0400","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:284"},{"text":"%angular\n<script type=\"text/javascript\">\n\n    $(function () {\n        if (typeof Highcharts == \"undefined\") {\n            $.getScript(\"http://code.highcharts.com/highcharts.js\")\n              .done(function( script, textStatus ) {\n                console.log( \"load http://code.highcharts.com/highcharts.js \" + textStatus );\n              })\n              .fail(function(jqxhr, settings, exception ) {\n                 console.log(\"load http://code.highcharts.com/highcharts.js \" + exception);\n              });\n        } else {\n            console.log(\"highcharts already loaded\");\n        }\n    });\n</script>\n<script type=\"text/javascript\">\n\n    $(function () {\n            $.getScript(\"https://code.highcharts.com/modules/drilldown.js\")\n              .done(function( script, textStatus ) {\n                console.log( \"load https://code.highcharts.com/modules/drilldown.js \" + textStatus );\n              })\n              .fail(function(jqxhr, settings, exception ) {\n                 console.log(\"load https://code.highcharts.com/modules/drilldown.js \" + exception);\n              });\n    });\n</script>","dateUpdated":"2016-12-13T23:32:50+0400","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481499231761_-2102929069","id":"20161212-033351_1932048549","result":{"code":"SUCCESS","type":"ANGULAR","msg":"<script type=\"text/javascript\">\n\n    $(function () {\n        if (typeof Highcharts == \"undefined\") {\n            $.getScript(\"http://code.highcharts.com/highcharts.js\")\n              .done(function( script, textStatus ) {\n                console.log( \"load http://code.highcharts.com/highcharts.js \" + textStatus );\n              })\n              .fail(function(jqxhr, settings, exception ) {\n                 console.log(\"load http://code.highcharts.com/highcharts.js \" + exception);\n              });\n        } else {\n            console.log(\"highcharts already loaded\");\n        }\n    });\n</script>\n<script type=\"text/javascript\">\n\n    $(function () {\n            $.getScript(\"https://code.highcharts.com/modules/drilldown.js\")\n              .done(function( script, textStatus ) {\n                console.log( \"load https://code.highcharts.com/modules/drilldown.js \" + textStatus );\n              })\n              .fail(function(jqxhr, settings, exception ) {\n                 console.log(\"load https://code.highcharts.com/modules/drilldown.js \" + exception);\n              });\n    });\n</script>"},"dateCreated":"2016-12-12T03:33:51+0400","dateStarted":"2016-12-12T03:34:40+0400","dateFinished":"2016-12-12T03:34:40+0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:285"},{"text":"import org.bson.Document\nimport com.mongodb.spark._\nimport com.mongodb.spark.config._\nimport com.knockdata.spark.highcharts._\nimport com.knockdata.spark.highcharts.model._\nimport com.knockdata.spark.highcharts.base._\n\nval readConfig = ReadConfig(Map(\"uri\" -> \"mongodb://localhost:27017/KTHeadHunter.resumes\"))\n\nimport org.apache.spark.sql.SparkSession\nval sparkSession = SparkSession.builder().getOrCreate()\nval rdd = MongoSpark.load(sparkSession, readConfig)\n\n","dateUpdated":"2016-12-13T23:32:39+0400","config":{"colWidth":12,"graph":{"mode":"stackedAreaChart","height":300,"optionOpen":false,"keys":[{"name":"age","index":0,"aggr":"sum"}],"values":[{"name":"count(1)","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"age","index":0,"aggr":"sum"},"yAxis":{"name":"count(1)","index":1,"aggr":"sum"}}},"enabled":true,"editorMode":"ace/mode/scala","editorHide":false,"tableHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481327153979_-1796532925","id":"20161210-034553_481128989","result":{"code":"SUCCESS","type":"TEXT","msg":"\nimport org.bson.Document\n\nimport com.mongodb.spark._\n\nimport com.mongodb.spark.config._\n\nimport com.knockdata.spark.highcharts._\n\nimport com.knockdata.spark.highcharts.model._\n\nimport com.knockdata.spark.highcharts.base._\n\nreadConfig: com.mongodb.spark.config.ReadConfig.Self = ReadConfig(KTHeadHunter,resumes,Some(mongodb://localhost:27017/KTHeadHunter.resumes),1000,DefaultMongoPartitioner,Map(),15,ReadPreferenceConfig(primary,None),ReadConcernConfig(None),false)\n\nimport org.apache.spark.sql.SparkSession\n\nsparkSession: org.apache.spark.sql.SparkSession = org.apache.spark.sql.SparkSession@4d67c4f5\n\nrdd: org.apache.spark.sql.DataFrame = [_id: struct<oid: string>, _progress: null ... 40 more fields]\n"},"dateCreated":"2016-12-10T03:45:53+0400","dateStarted":"2016-12-12T21:33:00+0400","dateFinished":"2016-12-12T21:33:39+0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:286","focus":true},{"text":"val dataFrame  = rdd.filter( x => \"gender.id\" != null ).groupBy(\"gender.id\").count()\n// val dataFrame = Seq( (\"Male\",5), (\"Female \",2) ).toDF(\"id\", \"count\")\n// dataFrame.show()\nval title = Title(\"\")\ntitle.fields += net.liftweb.json.JsonAST.JField(\"text\", JsonConversion.toJValue(\"Половое соотношение\"))\nval g = highcharts(dataFrame\n  .series(\"x\" -> \"id\", \"y\" -> \"count\",\"name\"->\"id\")\n  .orderBy(col(\"count\")))\n  .chart(Chart.pie)\n  .title(title.asInstanceOf[Title])","dateUpdated":"2016-12-12T18:19:46+0400","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala","editorHide":false,"tableHide":false},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481329493413_1920576213","id":"20161210-042453_2129322981","result":{"code":"ERROR","type":"TEXT","msg":"\n\n\n<console>:1: error: illegal start of declaration\n       val dataFrame  = rdd.filter( x => {$ne : {\"gender.id\" : null} ).groupBy(\"gender.id\").count()\n                                                 ^\n\n\n\n<console>:1: error: ';' expected but ')' found.\n       val dataFrame  = rdd.filter( x => {$ne : {\"gender.id\" : null} ).groupBy(\"gender.id\").count()\n                                                                     ^\n"},"dateCreated":"2016-12-10T04:24:53+0400","dateStarted":"2016-12-12T18:19:18+0400","dateFinished":"2016-12-12T18:19:24+0400","status":"ERROR","progressUpdateIntervalMs":500,"$$hashKey":"object:287","focus":true},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala","editorHide":true,"tableHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481555980719_-12277098","id":"20161212-191940_1859515972","dateCreated":"2016-12-12T19:19:40+0400","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3420","text":"val relocation  = rdd.groupBy(\"relocation.type.id\").agg(count(\"*\").alias(\"total\"),first(col(\"relocation.type.name\")).alias(\"name\"))\n//val relocation = Seq( (\"no_relocation\",5,\"хочу переехать\"), (\"relocation_desirable \",2,\"не готов к переезду\") ).toDF(\"id\", \"total\",\"name\")\nrelocation.show()\nval title = Title(\"\") \ntitle.fields += net.liftweb.json.JsonAST.JField(\"text\", JsonConversion.toJValue(\"Готовность к переезду\"))\nval relocationGraph = highcharts(relocation.series(\"x\" -> \"id\", \"y\" -> \"total\",\"name\"->\"name\")\n   .orderBy(col(\"total\")))\n   .chart(Chart.pie)\n   .title(title)","dateUpdated":"2016-12-12T21:21:54+0400","dateFinished":"2016-12-12T20:01:13+0400","dateStarted":"2016-12-12T19:59:40+0400","result":{"code":"SUCCESS","type":"TEXT","msg":"\nrelocation: org.apache.spark.sql.DataFrame = [id: string, total: bigint ... 1 more field]\n+--------------------+-----+-------------------+\n|                  id|total|               name|\n+--------------------+-----+-------------------+\n|       no_relocation|64511|не готов к переезду|\n|relocation_desirable| 4086|     хочу переехать|\n| relocation_possible|38824|   готов к переезду|\n+--------------------+-----+-------------------+\n\n\ntitle: com.knockdata.spark.highcharts.model.Title = com.knockdata.spark.highcharts.model.Title@4a8d9fc\n\nres121: title.fields.type = ListBuffer(JField(text,JString(Готовность к переезду)))\n\nrelocationGraph: com.knockdata.spark.highcharts.model.Highcharts = com.knockdata.spark.highcharts.model.Highcharts@5248c874\n"}},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481563319559_2008971017","id":"20161212-212159_1013628439","dateCreated":"2016-12-12T21:21:59+0400","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4233","text":"val totalExp = rdd.select(\"total_experience.months\")\ntotalExp.createOrReplaceTempView(\"totalExp\")\n\nval texp = spark.sql(\"SELECT 'Меньше года' as exp, count(months) FROM totalExp WHERE months > 0 AND months < 13 union all (SELECT 'от 1 до 3 лет' as exp, count(months) FROM totalExp WHERE months > 12 AND months < 37 union all (SELECT 'от 3 до 6 лет' as exp, count(months) FROM totalExp WHERE months > 36 AND months < 75 union all (SELECT 'более 6 лет' as exp, count(months) FROM totalExp WHERE months > 75)))\")\ntexp.show()","dateUpdated":"2016-12-12T22:20:29+0400","dateFinished":"2016-12-12T22:24:41+0400","dateStarted":"2016-12-12T22:20:29+0400","result":{"code":"SUCCESS","type":"TEXT","msg":"\ntotalExp: org.apache.spark.sql.DataFrame = [months: int]\n\ntexp: org.apache.spark.sql.DataFrame = [exp: string, count(months): bigint]\n+-------------+-------------+\n|          exp|count(months)|\n+-------------+-------------+\n|  Меньше года|         4740|\n|от 1 до 3 лет|        13849|\n|от 3 до 6 лет|        22105|\n|  более 6 лет|        65748|\n+-------------+-------------+\n\n"}},{"text":"g.plot()","dateUpdated":"2016-12-12T19:17:52+0400","config":{"colWidth":4,"graph":{"mode":"pieChart","height":389,"optionOpen":false,"keys":[{"name":"id","index":0,"aggr":"sum"}],"values":[{"name":"count","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"id","index":0,"aggr":"sum"},"yAxis":{"name":"count","index":1,"aggr":"sum"}}},"enabled":true,"editorMode":"ace/mode/scala","editorHide":false,"tableHide":false},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481329757869_912689505","id":"20161210-042917_88294518","result":{"code":"SUCCESS","type":"ANGULAR","msg":"\n<div id=\"highcharts_dd8e2773-bf31-4625-b1d3-278b146fa2fb\" style=\"min-width: 310px; height: 400px; margin: 0 auto\"></div>\n\n<script type=\"text/javascript\">\n$(function () {\nvar data = {\n  \"series\":[{\n    \"data\":[{\n      \"x\":null,\n      \"y\":1225,\n      \"name\":null\n    },{\n      \"x\":\"female\",\n      \"y\":11913,\n      \"name\":\"female\"\n    },{\n      \"x\":\"male\",\n      \"y\":94283,\n      \"name\":\"male\"\n    }]\n  }],\n  \"title\":{\n    \"text\":\"Половое соотношение\"\n  },\n  \"chart\":{\n    \"type\":\"pie\"\n  }\n}\n\n$(\"#highcharts_dd8e2773-bf31-4625-b1d3-278b146fa2fb\").highcharts(data)\n});\n</script>\n"},"dateCreated":"2016-12-10T04:29:17+0400","dateStarted":"2016-12-12T19:15:11+0400","dateFinished":"2016-12-12T19:16:09+0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:288","focus":true},{"config":{"colWidth":4,"graph":{"mode":"table","height":146,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481555902070_-599543482","id":"20161212-191822_1212761369","dateCreated":"2016-12-12T19:18:22+0400","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3350","dateUpdated":"2016-12-12T20:01:17+0400","dateFinished":"2016-12-12T20:01:24+0400","dateStarted":"2016-12-12T20:01:17+0400","result":{"code":"SUCCESS","type":"ANGULAR","msg":"\n<div id=\"highcharts_b515ad1b-168b-4933-a468-789e9b6554dc\" style=\"min-width: 310px; height: 400px; margin: 0 auto\"></div>\n\n<script type=\"text/javascript\">\n$(function () {\nvar data = {\n  \"series\":[{\n    \"data\":[{\n      \"x\":\"relocation_desirable\",\n      \"y\":4086,\n      \"name\":\"хочу переехать\"\n    },{\n      \"x\":\"relocation_possible\",\n      \"y\":38824,\n      \"name\":\"готов к переезду\"\n    },{\n      \"x\":\"no_relocation\",\n      \"y\":64511,\n      \"name\":\"не готов к переезду\"\n    }]\n  }],\n  \"title\":{\n    \"text\":\"Готовность к переезду\"\n  },\n  \"chart\":{\n    \"type\":\"pie\"\n  }\n}\n\n$(\"#highcharts_b515ad1b-168b-4933-a468-789e9b6554dc\").highcharts(data)\n});\n</script>\n"},"text":"relocationGraph.plot()"},{"config":{"colWidth":4,"graph":{"mode":"table","height":86,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481555899446_-1168202356","id":"20161212-191819_2123219649","dateCreated":"2016-12-12T19:18:19+0400","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3280","text":"","dateUpdated":"2016-12-12T19:19:14+0400"},{"text":"val k  = rdd.select(\"specialization\")\nval p = k.withColumn(\"specialization\", explode($\"specialization\"))\n  .select($\"specialization.name\" as \"name\", $\"specialization.id\" as \"id\")\nval specialization = p.groupBy(\"id\").agg(count(\"*\").alias(\"total\"),first(col(\"name\")).alias(\"name\")).sort(desc(\"total\")).limit(10)\nspecialization.show()\n\n","dateUpdated":"2016-12-13T01:13:46+0400","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala","editorHide":false,"tableHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481404680917_-1578066100","id":"20161211-011800_673194570","result":{"code":"SUCCESS","type":"TEXT","msg":"\nk: org.apache.spark.sql.DataFrame = [specialization: array<struct<profarea_id:string,profarea_name:string,id:string,laboring:boolean,name:string>>]\n\np: org.apache.spark.sql.DataFrame = [name: string, id: string]\n\nspecialization: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [id: string, total: bigint ... 1 more field]\n+-----+-----+--------------------+\n|   id|total|                name|\n+-----+-----+--------------------+\n|1.273|32136|Системный админис...|\n|1.221|25964|Программирование,...|\n| 1.82|23727|             Инженер|\n|1.270|21089|  Сетевые технологии|\n| 1.89|20388|            Интернет|\n|1.327|16460|Управление проектами|\n|1.211|13319| Поддержка, Helpdesk|\n|1.295|12979|    Телекоммуникации|\n|1.203| 8197|Передача данных и...|\n|  1.3| 8098|CTO, CIO, Директо...|\n+-----+-----+--------------------+\n\n"},"dateCreated":"2016-12-11T01:18:00+0400","dateStarted":"2016-12-12T21:10:58+0400","dateFinished":"2016-12-12T21:13:09+0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:290","focus":true},{"text":"import scala.collection.mutable.ListBuffer\n\nvar list = new ListBuffer[String]()\n\nval dataFrame = specialization// Seq( (\"Male\",5), (\"Female\",2) ).toDF(\"name\", \"total\")\n\nval cats = dataFrame.select(\"name\").rdd.map(r => r(0)).collect()\nfor(i <- 0 until cats.length){\n    list += cats(i).toString\n}\n\nval l = list.toList\n\nval chart = highcharts(dataFrame.series(\"y\" -> \"total\",\"name\"->\"name\"))\n   .chart(Chart.column)\n   .plotOptions(PlotOptions.column)\n   .xAxis(XAxis(\"\").categories(l))\n\n chart.plot()","dateUpdated":"2016-12-13T01:04:37+0400","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[{"name":"id","index":0,"aggr":"sum"}],"values":[{"name":"count","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"id","index":0,"aggr":"sum"},"yAxis":{"name":"count","index":1,"aggr":"sum"}}},"enabled":true,"editorMode":"ace/mode/scala","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481406007045_-1616068706","id":"20161211-014007_408866092","result":{"code":"SUCCESS","type":"ANGULAR","msg":"\n<div id=\"highcharts_b94db68d-b198-47d5-9db9-9935b3c2fff1\" style=\"min-width: 310px; height: 400px; margin: 0 auto\"></div>\n\n<script type=\"text/javascript\">\n$(function () {\nvar data = {\n  \"series\":[{\n    \"data\":[{\n      \"y\":32136,\n      \"name\":\"Системный администратор\"\n    },{\n      \"y\":25964,\n      \"name\":\"Программирование, Разработка\"\n    },{\n      \"y\":23727,\n      \"name\":\"Инженер\"\n    },{\n      \"y\":21089,\n      \"name\":\"Сетевые технологии\"\n    },{\n      \"y\":20388,\n      \"name\":\"Интернет\"\n    },{\n      \"y\":16460,\n      \"name\":\"Управление проектами\"\n    },{\n      \"y\":13319,\n      \"name\":\"Поддержка, Helpdesk\"\n    },{\n      \"y\":12979,\n      \"name\":\"Телекоммуникации\"\n    },{\n      \"y\":8197,\n      \"name\":\"Передача данных и доступ в интернет\"\n    },{\n      \"y\":8098,\n      \"name\":\"CTO, CIO, Директор по IT\"\n    }]\n  }],\n  \"xAxis\":{\n    \"categories\":[\"Системный администратор\",\"Программирование, Разработка\",\"Инженер\",\"Сетевые технологии\",\"Интернет\",\"Управление проектами\",\"Поддержка, Helpdesk\",\"Телекоммуникации\",\"Передача данных и доступ в интернет\",\"CTO, CIO, Директор по IT\"]\n  },\n  \"chart\":{\n    \"type\":\"column\"\n  },\n  \"plotOptions\":{\n    \"column\":{\n      \n    }\n  }\n}\n\n$(\"#highcharts_b94db68d-b198-47d5-9db9-9935b3c2fff1\").highcharts(data)\n});\n</script>\n"},"dateCreated":"2016-12-11T01:40:07+0400","dateStarted":"2016-12-12T21:14:06+0400","dateFinished":"2016-12-12T21:17:25+0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:293","focus":true},{"text":"rdd.createOrReplaceTempView(\"table\")\nval teenagerNamesDF = spark.sql(\"SELECT id,salary.amount,salary.currency,specialization.id as spec,specialization.name as specName FROM table WHERE area.id = 2\")\nteenagerNamesDF.show()\n\nteenagerNamesDF.createOrReplaceTempView(\"spbSalary\")\n\nval total = spark.sql(\"SELECT '1.221' as spec,AVG(amount) FROM spbSalary WHERE array_contains(spec,'1.221') AND currency = 'RUR' AND amount > 0  union all ((SELECT '1.227' as spec,AVG(amount) FROM spbSalary WHERE array_contains(spec,'1.272') AND currency = 'RUR') union all (SELECT '1.30' as spec,AVG(amount) FROM spbSalary WHERE array_contains(spec,'1.30') AND currency = 'RUR'))\")\n\ntotal.show()\n","dateUpdated":"2016-12-13T01:19:32+0400","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala","editorHide":false},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481406052481_1601848501","id":"20161211-014052_1790267571","result":{"code":"SUCCESS","type":"TEXT","msg":"\nteenagerNamesDF: org.apache.spark.sql.DataFrame = [id: string, amount: int ... 3 more fields]\n+--------------------+------+--------+--------------------+--------------------+\n|                  id|amount|currency|                spec|            specName|\n+--------------------+------+--------+--------------------+--------------------+\n|b99407d6000085cd5...| 90000|     RUR|      [1.475, 1.221]|[Игровое ПО, Прог...|\n|e063457400022ead2...|130000|     RUR|       [1.221, 1.82]|[Программирование...|\n|4936275b00002f21e...|100000|     RUR|[1.221, 1.272, 1.82]|[Программирование...|\n|f9fb0bfb00020cae2...|100000|     RUR|[1.221, 1.273, 1....|[Программирование...|\n|591187b7000371f18...|100000|     RUR|[1.221, 1.327, 1....|[Программирование...|\n|a53cfdd300006a300...| 90000|     RUR|[1.221, 1.82, 1.327]|[Программирование...|\n|ab74add5000298495...| 90000|     RUR|[1.221, 1.82, 1.420]|[Программирование...|\n|b7a8e6b300036e1c5...|100000|     RUR|[1.221, 1.117, 1.25]|[Программирование...|\n|81a4bd7d0000e120c...|100000|     RUR|[1.221, 1.50, 1.327]|[Программирование...|\n|575bc41200020b6a7...| 95000|     RUR|      [1.475, 1.221]|[Игровое ПО, Прог...|\n|e3b889b200035f709...| 99990|     RUR|       [1.221, 1.82]|[Программирование...|\n|ef59c6f3000376668...| 85000|     RUR|             [1.221]|[Программирование...|\n|3fe12060000037430...|110000|     RUR|[1.221, 1.270, 1....|[Программирование...|\n|93dbfbb2000371f2f...|  2000|     USD|[1.221, 1.327, 1....|[Software Develop...|\n|4a383a590002dcdea...|  2600|     USD|[1.30, 1.327, 1.474]|[Арт-директор, Уп...|\n|b1cc4d5500020af6e...|  1200|     USD|       [1.475, 1.30]|[Игровое ПО, Арт-...|\n|e5899f370000e3d13...|  null|    null|  [1.30, 1.89, 1.10]|[Арт-директор, Ин...|\n|b707ebe30000174de...|  null|    null|        [1.30, 1.89]|[Арт-директор, Ин...|\n|ef836f020001cecea...|  null|    null|       [1.30, 1.161]|[Арт-директор, Му...|\n|87107d75000185167...|  null|    null|[1.30, 1.246, 1.474]|[Арт-директор, Ра...|\n+--------------------+------+--------+--------------------+--------------------+\nonly showing top 20 rows\n\n\ntotal: org.apache.spark.sql.DataFrame = [spec: string, avg(amount): double]\n+-----+-----------------+\n| spec|      avg(amount)|\n+-----+-----------------+\n|1.221|60122.90371575807|\n|1.227|60528.44175491679|\n| 1.30|58556.51304347826|\n+-----+-----------------+\n\n"},"dateCreated":"2016-12-11T01:40:52+0400","dateStarted":"2016-12-13T01:19:34+0400","dateFinished":"2016-12-13T01:21:13+0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:294","focus":true},{"text":"val educationPrimary  = rdd.select(\"education.primary\")\nval educationPrimaryWithColumn = educationPrimary.withColumn(\"primary\", explode($\"primary\"))\n  .select($\"primary.name\" as \"name\", $\"primary.name_id\" as \"id\")\nval educationGroupBy = educationPrimaryWithColumn.groupBy(\"id\").agg(count(\"*\").alias(\"total\"),first(col(\"name\")).alias(\"name\")).sort(desc(\"total\")).limit(10)\neducationGroupBy.createOrReplaceTempView(\"educationGroupBy\")\nval educationResult = spark.sql(\"SELECT * FROM educationGroupBy WHERE total < 80000\")\neducationResult.show()\n\n\n","dateUpdated":"2016-12-13T02:30:06+0400","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481408312999_-478291232","id":"20161211-021832_1337635634","result":{"code":"SUCCESS","type":"TEXT","msg":"\neducationPrimary: org.apache.spark.sql.DataFrame = [primary: array<struct<name:string,name_id:string,organization:string,organization_id:string,result:string,result_id:string,year:int>>]\n\neducationPrimaryWithColumn: org.apache.spark.sql.DataFrame = [name: string, id: string]\n\neducationGroupBy: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [id: string, total: bigint ... 1 more field]\n\neducationResult: org.apache.spark.sql.DataFrame = [id: string, total: bigint ... 1 more field]\n+-----+-----+--------------------+\n|   id|total|                name|\n+-----+-----+--------------------+\n|38921| 1492|Московский госуда...|\n|39144| 1433|Московский госуда...|\n|39594| 1376|Московский авиаци...|\n|38931| 1287|Московский технич...|\n|39765| 1224|Санкт-Петербургск...|\n|38929| 1168|Московский госуда...|\n|39872| 1018|Санкт-Петербургск...|\n|39692| 1009|Санкт-Петербургск...|\n|39043|  950|Московский госуда...|\n|39650|  881|Национальный иссл...|\n+-----+-----+--------------------+\n\n"},"dateCreated":"2016-12-11T02:18:32+0400","dateStarted":"2016-12-13T02:28:12+0400","dateFinished":"2016-12-13T02:29:03+0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:295","focus":true},{"text":"s.show()\n","dateUpdated":"2016-12-12T16:38:45+0400","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":true,"keys":[{"name":"count(names)","index":0,"aggr":"sum"}],"values":[{"name":"names","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"count(names)","index":0,"aggr":"sum"},"yAxis":{"name":"names","index":1,"aggr":"sum"}}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481466941897_1023874631","id":"20161211-183541_2072702807","result":{"code":"SUCCESS","type":"TEXT","msg":"+-------+-----+\n|name_id|count|\n+-------+-----+\n|  42743|   46|\n|  39350|    1|\n|  45300|    1|\n|  39659|    3|\n|  39645|    4|\n|  47140|    1|\n|  39641|    1|\n|  42688|    1|\n|  44717|    1|\n|  39692|  909|\n+-------+-----+\n\n"},"dateCreated":"2016-12-11T06:35:41+0400","dateStarted":"2016-12-12T16:38:46+0400","dateFinished":"2016-12-12T16:41:28+0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:296","focus":true},{"text":"rdd.createOrReplaceTempView(\"table\")\n\nval timeAndCount = spark.sql(\n    \"SELECT '11' as month, COUNT(id) FROM table WHERE created_at < '2016-12-01T00:00:00+0300' and created_at > '2016-11-01T00:00:00+0300' OR updated_at < '2016-12-01T00:00:00+0300' and updated_at > '2016-10-01T00:00:00+0300' union all \" +\n    \"SELECT '10' as month, COUNT(id) FROM table WHERE created_at < '2016-11-01T00:00:00+0300' and created_at > '2016-10-01T00:00:00+0300' OR updated_at < '2016-11-01T00:00:00+0300' and updated_at > '2016-9-01T00:00:00+0300'\")\ntimeAndCount.show()\n","dateUpdated":"2016-12-11T08:00:36+0400","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481468060965_39462539","id":"20161211-185420_559668697","result":{"code":"SUCCESS","type":"TEXT","msg":"\ntimeAndCount: org.apache.spark.sql.DataFrame = [month: string, count(id): bigint]\n+-----+---------+\n|month|count(id)|\n+-----+---------+\n|   11|    15046|\n|   10|     1736|\n+-----+---------+\n\n"},"dateCreated":"2016-12-11T06:54:20+0400","dateStarted":"2016-12-11T07:55:10+0400","dateFinished":"2016-12-11T07:57:06+0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:297"},{"text":"","dateUpdated":"2016-12-11T08:45:34+0400","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1481474692764_1628544942","id":"20161211-204452_119422494","dateCreated":"2016-12-11T08:44:52+0400","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:300","focus":true}],"name":"HeadHunter","id":"2C2VVPURE","angularObjects":{"2C56RSWHB:shared_process":[],"2C66Z8AP4:shared_process":[],"2C3UMXK9Y:shared_process":[],"2C54TRRT3:shared_process":[],"2C4C9QDWC:shared_process":[],"2C3MY7M6R:shared_process":[],"2C4TZRXCE:shared_process":[],"2C4RBUT37:shared_process":[],"2C4DGX5CD:shared_process":[],"2C6ERS52D:shared_process":[],"2C3EM4V21:shared_process":[],"2C4M7BMZJ:shared_process":[],"2C3ASW746:shared_process":[],"2C3NYMMNY:shared_process":[],"2C5PBGJQR:shared_process":[],"2C2YQC2QW:shared_process":[],"2C4KZRXXJ:shared_process":[],"2C4UYBBZ8:shared_process":[]},"config":{"looknfeel":"default"},"info":{}}